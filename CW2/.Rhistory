R = 1
Rsmall = 4
Rlarge = 50
t <- 4
levels = 11
G <- seq(0.018, 0.02, length.out = levels)
C <- seq(0.1, 0.2, length.out = levels)
Tgen <- 400
K = 0.1
source('extensionHeader.r')
#---------------------------------------
#-- STEP 1. INITIALISE N INDIVIDUALS ---
#---------------------------------------
# Because we are using R we describe individuals in a vectorised mannor. Each element of the vector is an allele, with a 3rd variable stating which group the group and 4th the size of the genotype.
initial <- N/(levels*2)
dispersedPop <- data.table(group = c("small", "large"))
invisible(sapply(1:levels, function (x) {
dispersedPop[, paste0("level",x) :=  rep(0, 2)]
}))
dispersedPop$level6 <- rep(N/2,2)
# Initialise population table with maximum number of group sizes
maxGroups <- floor(N/groupSizeSmall)
population <- data.table(id = 1:maxGroups, group = NA_character_)
invisible(sapply(1:levels, function(x) {
population[, paste0("level", x) := NA_real_]
}))
genotypes <- data.table(level1small = c(initial, rep(NA_real_, Tgen)))
invisible(sapply(1:levels, function(x) {
genotypes[, paste0("level", x, "small") := c(initial, rep(NA_real_, Tgen))]
}))
invisible(sapply(1:levels, function(x) {
genotypes[, paste0("level", x, "large") := c(initial, rep(NA_real_, Tgen))]
}))
for (j in 1:Tgen) { # iterate for T generations
groupFormation()
for (i in 1:t) {
reproduction() # wait time t before mixing
mutate(0.1)
}
buildMigrantPool()
print(dispersedPop)
# Empty the groups
invisible(sapply(1:levels, function(x) {
population[, paste0("level", x) := NA_real_]
}))
# Save population values after each generation
x <- dispersedPop[1, setdiff(colnames(dispersedPop),c("group","Sum")), with=FALSE]
y <- dispersedPop[2, setdiff(colnames(dispersedPop),c("group","Sum")), with=FALSE]
row <- cbind(x,y)
row[is.na(row)]<-0
set(genotypes, as.integer(j + 1), names(genotypes), as.list(round(row)))
# Print current state to console
print(paste("Generation:", j))
print(genotypes[j])
save(genotypes, file = "genotypes.Rda")
}
save(genotypes, file = "genotypes2.Rda")
load('genotypes2.rda')
genotypes
View(genotypes)
load("~/Southampton/EvolutionOfComplexity/CW2/genotypes2.Rda")
View(genotypes)
library(data.table)
library(ggplot2)
library(gridExtra)
#load("~/Southampton/EvolutionOfComplexity/CW2/genotypes.Rda")
genotypes[, smallPop := rowSums(.SD, na.rm = T), .SDcols = 1:11]
genotypes[, largePop := rowSums(.SD, na.rm = T), .SDcols = 12:22]
colNamesSmall <- grep("level.*small",names(genotypes), value = T)
colNamesLarge <- grep("level.*large",names(genotypes), value = T)
genotypes[, smallCoop :=
level1small +
2*level2small +
3*level3small +
4*level4small +
5*level5small +
6*level6small +
7*level7small +
8*level8small +
9*level9small +
10*level10small +
11*level11small
]
genotypes[, smallCoop := smallCoop / smallPop]
genotypes[, largeCoop :=
level1large +
2*level2large +
3*level3large +
4*level4large +
5*level5large +
6*level6large +
7*level7large +
8*level8large +
9*level9large +
10*level10large +
11*level11large
]
genotypes[, largeCoop := largeCoop / largePop]
science_theme = theme(panel.grid.major = element_line(size = 0.5, color = "grey"),
panel.grid.minor.y = element_blank(),
axis.line = element_line(size = 0.7, color = "black"),
legend.position = c(0.8,0.7),
text = element_text(size = 26))
graph2 <- ggplot(data = genotypes, aes(x = 1:401, y = largePop)) +
xlim(0,301) +
ylim(1800,2200) +
theme_bw() +
science_theme +
geom_line(aes(y = largePop, col = "largePop", linetype = "largePop", size = "largePop")) +
geom_line(aes(y = smallPop, col = "smallPop", linetype = "smallPop", size = "smallPop")) +
xlab("Generation") +
ylab("Global genotype frequencey") +
scale_colour_manual("",
breaks = c("largePop", "smallPop"),
values = c("Dark grey", "Black")) +
scale_linetype_manual("",
breaks = c("largePop", "smallPop"),
values = c(1, 1)) +
scale_size_manual("",
breaks = c("largePop", "smallPop"),
values = rep(1.4,2))
graph1 <- ggplot(data = genotypes, aes(x = 1:401, y = largePop)) +
xlim(0,301) +
theme_bw() +
science_theme +
geom_line(aes(y = largeCoop, col = "largePop", linetype = "largePop", size = "largePop")) +
geom_line(aes(y = smallCoop, col = "smallPop", linetype = "smallPop", size = "smallPop")) +
xlab("Generation") +
ylab("Average greed level") +
scale_colour_manual("",
breaks = c("largePop", "smallPop"),
values = c("Dark grey", "Black")) +
scale_linetype_manual("",
breaks = c("largePop", "smallPop"),
values = c(1, 1)) +
scale_size_manual("",
breaks = c("largePop", "smallPop"),
values = rep(1.4,2))
grid.arrange(graph2, graph1, nrow=1, ncol=2)
genotypes
head(genotypes)
load("~/Southampton/EvolutionOfComplexity/CW2/genotypes.Rda")
head(genotypes)
getwd()
2150/1850
library(data.table)
library(ggplot2)
library(gridExtra)
load("~/Southampton/EvolutionOfComplexity/CW2/genotypes.Rda")
genotypes[, smallPop := rowSums(.SD, na.rm = T), .SDcols = 1:11]
genotypes[, largePop := rowSums(.SD, na.rm = T), .SDcols = 12:22]
colNamesSmall <- grep("level.*small",names(genotypes), value = T)
colNamesLarge <- grep("level.*large",names(genotypes), value = T)
genotypes[, smallCoop :=
level1small +
2*level2small +
3*level3small +
4*level4small +
5*level5small +
6*level6small +
7*level7small +
8*level8small +
9*level9small +
10*level10small +
11*level11small
]
genotypes[, smallCoop := smallCoop / smallPop]
genotypes[, largeCoop :=
level1large +
2*level2large +
3*level3large +
4*level4large +
5*level5large +
6*level6large +
7*level7large +
8*level8large +
9*level9large +
10*level10large +
11*level11large
]
genotypes[, largeCoop := largeCoop / largePop]
science_theme = theme(panel.grid.major =
element_line(size = 0.5, color = "grey"),
panel.grid.minor.y = element_blank(),
axis.line =
element_line(size = 0.7, color = "black"),
legend.position = c(0.8,0.7),
text = element_text(size = 26))
graph2 <- ggplot(data = genotypes, aes(x = 1:401, y = largePop)) +
xlim(0,301) +
ylim(1800,2200) +
theme_bw() +
science_theme +
geom_line(aes(y = largePop, col = "largePop",
linetype = "largePop", size = "largePop")) +
geom_line(aes(y = smallPop, col = "smallPop",
linetype = "smallPop", size = "smallPop")) +
xlab("Generation") +
ylab("Global genotype frequencey") +
scale_colour_manual("",
breaks = c("largePop", "smallPop"),
values = c("Dark grey", "Black")) +
scale_linetype_manual("",
breaks = c("largePop", "smallPop"),
values = c(1, 1)) +
scale_size_manual("",
breaks = c("largePop", "smallPop"),
values = rep(1.4,2))
graph1 <- ggplot(data = genotypes, aes(x = 1:401, y = largePop)) +
xlim(0,301) +
theme_bw() +
science_theme +
geom_line(aes(y = largeCoop, col = "largePop",
linetype = "largePop", size = "largePop")) +
geom_line(aes(y = smallCoop, col = "smallPop",
linetype = "smallPop", size = "smallPop")) +
xlab("Generation") +
ylab("Average greed level") +
scale_colour_manual("",
breaks = c("largePop", "smallPop"),
values = c("Dark grey", "Black")) +
scale_linetype_manual("",
breaks = c("largePop", "smallPop"),
values = c(1, 1)) +
scale_size_manual("",
breaks = c("largePop", "smallPop"),
values = rep(1.4,2))
grid.arrange(graph2, graph1, nrow=1, ncol=2)
View(genotypes)
newPlot <- genotypes[, smallCoop :=
level1small +
2*level2small +
3*level3small +
4*level4small +
5*level5small +
6*level6small +
7*level7small +
8*level8small +
9*level9small +
10*level10small +
11*level11small
]
plot(newPlot)
newPlot
plot(newPlot$level1small)
plot(newPlot$level1small, type = "l")
plot(newPlot$level2small, type = "l")
plot(newPlot$level1small, type = "l")
lines(newPlot$level1small, type = "l")
plot(newPlot$level1small, type = "l")
lines(newPlot$level2small, type = "l")
lines(newPlot$level3small, type = "l")
lines(newPlot$level4small, type = "l")
lines(newPlot$level5small, type = "l")
lines(newPlot$level6small, type = "l")
lines(newPlot$level7small, type = "l")
lines(newPlot$level8small, type = "l")
lines(newPlot$level9small, type = "l")
lines(newPlot$level10small, type = "l")
lines(newPlot$level11small, type = "l")
ggplot(newPlot) +
geom_line(aes(x = 1:100, y = level1small))
ggplot(newPlot) +
geom_line(aes(x = 1:100, y = level1small[1:100]))
length(y)
length(newplot$level1small)
length(newPlot$level1small)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small))
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small)) +
geom_line(aes(y = level2small)) +
geom_line(aes(y = level3small)) +
geom_line(aes(y = level4small)) +
geom_line(aes(y = level5small)) +
geom_line(aes(y = level6small)) +
geom_line(aes(y = level7small)) +
geom_line(aes(y = level8small)) +
geom_line(aes(y = level9small)) +
geom_line(aes(y = level10small)) +
geom_line(aes(y = level11small))
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small)) +
geom_line(aes(y = level2small)) +
geom_line(aes(y = level3small)) +
geom_line(aes(y = level4small)) +
geom_line(aes(y = level5small)) +
geom_line(aes(y = level6small)) +
geom_line(aes(y = level7small)) +
geom_line(aes(y = level8small)) +
geom_line(aes(y = level9small)) +
geom_line(aes(y = level10small)) +
geom_line(aes(y = level11small)) +
xlim(0,60)
cols <- grey.colors(11)
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = cols[1])) +
geom_line(aes(y = level2small, col = cols[2])) +
geom_line(aes(y = level3small, col = cols[3])) +
geom_line(aes(y = level4small, col = cols[4])) +
geom_line(aes(y = level5small, col = cols[5])) +
geom_line(aes(y = level6small, col = cols[6])) +
geom_line(aes(y = level7small, col = cols[7])) +
geom_line(aes(y = level8small, col = cols[8])) +
geom_line(aes(y = level9small, col = cols[9])) +
geom_line(aes(y = level10small, col = cols[10])) +
geom_line(aes(y = level11small, col = cols[11])) +
xlim(0,60)
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = cols[1])) +
geom_line(aes(y = level2small, col = cols[2])) +
geom_line(aes(y = level3small, col = cols[3])) +
geom_line(aes(y = level4small, col = cols[4])) +
geom_line(aes(y = level5small, col = cols[5])) +
geom_line(aes(y = level6small, col = cols[6])) +
geom_line(aes(y = level7small, col = cols[7])) +
geom_line(aes(y = level8small, col = cols[8])) +
geom_line(aes(y = level9small, col = cols[9])) +
geom_line(aes(y = level10small, col = cols[10])) +
geom_line(aes(y = level11small, col = cols[11])) +
xlim(0,60)
ggplot(newPlot, aes(x = 1:401)) +
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = level1))
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1"))
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9") +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60)
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme
science_theme = theme(panel.grid.major =
element_line(size = 0.5, color = "grey"),
panel.grid.minor.y = element_blank(),
axis.line =
element_line(size = 0.7, color = "black"),
legend.position = c(0.8,0.4),
text = element_text(size = 26))
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency")
science_theme = theme(panel.grid.major =
element_line(size = 0.5, color = "grey"),
panel.grid.minor.y = element_blank(),
axis.line =
element_line(size = 0.7, color = "black"),
legend.position = c(0.8,0.5),
text = element_text(size = 26))
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency")
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency") +
guide_legend(title = "")
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency") +
guide_legend(title = NULL)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency")
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1small, col = "level1")) +
geom_line(aes(y = level2small, col = "level2")) +
geom_line(aes(y = level3small, col = "level3")) +
geom_line(aes(y = level4small, col = "level4")) +
geom_line(aes(y = level5small, col = "level5")) +
geom_line(aes(y = level6small, col = "level6")) +
geom_line(aes(y = level7small, col = "level7")) +
geom_line(aes(y = level8small, col = "level8")) +
geom_line(aes(y = level9small, col = "level9")) +
geom_line(aes(y = level10small, col = "level10")) +
geom_line(aes(y = level11small, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency") +
theme(legend.title=element_blank())
cols <- grey.colors(11)
ggplot(newPlot, aes(x = 1:401)) +
geom_line(aes(y = level1large, col = "level1")) +
geom_line(aes(y = level2large, col = "level2")) +
geom_line(aes(y = level3large, col = "level3")) +
geom_line(aes(y = level4large, col = "level4")) +
geom_line(aes(y = level5large, col = "level5")) +
geom_line(aes(y = level6large, col = "level6")) +
geom_line(aes(y = level7large, col = "level7")) +
geom_line(aes(y = level8large, col = "level8")) +
geom_line(aes(y = level9large, col = "level9")) +
geom_line(aes(y = level10large, col = "level10")) +
geom_line(aes(y = level11large, col = "level11")) +
xlim(0,60) +
theme_bw() +
science_theme +
xlab("Generation") +
ylab("Genotype Frequency") +
theme(legend.title=element_blank())
